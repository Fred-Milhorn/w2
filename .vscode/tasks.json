{
	"version": "2.0.0",
	"tasks": [
		{
			"label": "Cargo: Check",
			"type": "shell",
			"command": "cargo",
			"args": [
				"check"
			],
			"isBackground": false,
			"problemMatcher": [
				"$rustc"
			],
			"group": "build"
		},
		{
			"label": "Cargo: Build (debug)",
			"type": "shell",
			"command": "cargo",
			"args": [
				"build"
			],
			"isBackground": false,
			"problemMatcher": [
				"$rustc"
			],
			"group": "build"
		},
		{
			"label": "Cargo: Run tests (harness)",
			"type": "shell",
			"command": "bash",
			"args": [
				"-lc",
				"STAGE=${input:stage} CHAPTER=${input:chapter} ./w2test.sh"
			],
			"isBackground": false,
			"group": "test"
		}
	,
	{
		"label": "w2: Run active file (full)",
		"type": "shell",
		"command": "bash",
		"args": [
			"-lc",
			"target/debug/w2 ${input:w2Debug} \"${file}\""
		],
		"dependsOn": [
			"Cargo: Build (debug)"
		],
		"group": "test",
		"problemMatcher": []
	},
	{
		"label": "w2: Run active file (pick stage)",
		"type": "shell",
		"command": "bash",
		"args": [
			"-lc",
			"target/debug/w2 ${input:w2Debug} ${input:w2StageFlag} \"${file}\""
		],
		"dependsOn": [
			"Cargo: Build (debug)"
		],
		"group": "test",
		"problemMatcher": []
	}
	]
,
	"inputs": [
		{
			"id": "chapter",
			"type": "promptString",
			"description": "Chapter number to test (e.g., 10)",
			"default": "10"
		},
		{
			"id": "stage",
			"type": "pickString",
			"description": "Optional stage to run (leave empty for full pipeline)",
			"options": [
				"",
				"parse",
				"validate",
				"tacky",
				"codegen",
				"emitcode"
			],
			"default": ""
		},
		{
			"id": "w2StageFlag",
			"type": "pickString",
			"description": "Compiler stage flag for w2 (leave empty to compile end-to-end)",
			"options": [
				"",
				"--lex",
				"--parse",
				"--validate",
				"--tacky",
				"--codegen",
				"--emitcode",
				"--compile"
			],
			"default": ""
		},
		{
			"id": "w2Debug",
			"type": "pickString",
			"description": "Include --debug output?",
			"options": [
				"",
				"--debug"
			],
			"default": "--debug"
		}
	]
}